<!DOCTYPE html>
<html><head>
<link rel="apple-touch-startup-image" href="css/smt/bg.png"/>
<link rel="apple-touch-icon" href="css/smt/screen-icon.png"/>
<meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=0"/>
<meta name="apple-mobile-web-app-capable" content="yes"/><meta name="apple-mobile-web-app-status-bar-style" content="black"/>
<title>Tagbum Mobile</title>
<link rel="icon" href="css/smt/favicon.ico" type="image/png"/>
<link rel="stylesheet" href="css/jquery.mobile.custom.css"/>
<link rel="stylesheet" href="css/jquery.mobile-1.3.2.css"/>
<link rel="stylesheet" href="css/jquery.Jcrop.css"/>
<link rel="stylesheet" href="css/iScroll.css"/>
<link rel="stylesheet" href="css/ptrScroll.css"/>
<link rel="stylesheet" href="css/farbtastic.css"/>
<link rel="stylesheet" href="css/seemytag.css"/>
<link rel="stylesheet" href="css/colorPicker.css"/>
<script src="cordova.js"></script>
<!--<script src="http://debug.build.phonegap.com/target/target-script-min.js#82ad4bcc-195f-11e3-af04-22000a98b3d6"></script><!-- -->
<script src="js/core/const.js"></script>
<script src="js/core/md5.js"></script>
<script src="js/core/jquery-1.10.2.min.js"></script>
<script src="js/core/jquery.cookie.js"></script>
<script src="js/core/jquery.local.js"></script>
<script src="js/core/session.js"></script>
<script src="js/core/jquery.mobile-1.3.2.js"></script>
<script src="js/core/jquery.form.js"></script>
<script src="js/core/jquery.textCounter.js"></script>
<script src="js/core/jquery.Jcrop.js"></script>
<script src="js/core/iScroll.js"></script>
<script src="js/core/jScroll.js"></script>
<script src="js/core/farbtastic.js"></script>
<script src="js/core/colorPicker.js"></script>
<script src="js/min.js"></script>
</head><body><script> var opc={type:1,dato:[]}; </script>
<div id="page-preferences" data-role="page" data-cache="false">
<div data-role="header" data-position="fixed" data-theme="f">
<a id="buttonBack_preferences" href="#" data-icon="arrow-l" onclick="goBack();"></a>
<h1>&nbsp;</h1>
<a id="btnPreferences_update" style="display:none" href="#" onClick="savePreferences(opc);" data-icon="check"></a>
</div>
<div data-role="content" class="list-content">
<img class="bg" src="img/bg.png" />
<div id="fs-wrapper" class="fs-wrapper">
<div id="scroller">
<div class="smt-tag-content" style="text-align: left">
<fieldset data-role="controlgroup">
<legend id="titleOptionPrefe" style="font-weight: bold">&nbsp;</legend>
<input type="radio" name="radio-choice-1" id="radio-choice-1" value="choice-1" onclick="changePrefe(opc,1);" />
<label for="radio-choice-1" id="labelTypePrefe1"></label>
<input type="radio" name="radio-choice-1" id="radio-choice-2" value="choice-2" onclick="changePrefe(opc,2);" />
<label for="radio-choice-2" id="labelTypePrefe2"></label>
<input type="radio" name="radio-choice-1" id="radio-choice-3" value="choice-3" onclick="changePrefe(opc,3);" />
<label for="radio-choice-3" id="labelTypePrefe3"</label>
</fieldset>
<label id="labelTxtPrefe" for="txtPreFe"></label>
<textarea id="txtPrefe" name="txtPrefe" style="resize: none;" ></textarea>
<span id="prefere_legend" style="font-size: 10px;display:block;"></span>
<input id="typePre" name="typePre" type="hidden" value="" />
</div>
</div>
</div>
</div>
<div id="footer" data-role="footer" data-position="fixed" data-theme="f">
<div data-role="navbar">
<ul>
<li><a id="labelChoosePre" class="ui-btn-active" onclick="redir(PAGE['preferences']);" >&nbsp;</a></li>
<li><a id="labelSeekPre" onclick="redir(PAGE['seekpreferences']);">&nbsp;</a></li>
<li><a id="labelMyPrefe" onclick="preferencesUsers();"></a></li>
</ul>
</div>
</div>
<script>
pageShow({
id:'#page-preferences',
title:lang.USERPROFILE_PREFERENCES,
before:function(){
//languaje
$('#buttonBack_preferences').html(lan('Back'));
$('#labelTypePrefe1').html(lang.PREFERENCES_WHATILIKE);
$('#labelTypePrefe2').html(lang.PREFERENCES_WHATIWANT);
$('#labelTypePrefe3').html(lang.PREFERENCES_WHATINEED);
$('#titleOptionPrefe').html('<strong>'+lang.PREFERENCES_LBLCHOOSEOP+':</strong>');
$('#labelTxtPrefe').html('<strong>'+lang.USERPROFILE_PREFERENCES_TITLE+':</strong>');
$('#prefere_legend').html(lang.PREFERENCES_HOLDERSEARCH);
$('#labelSeekPre').html(lang.seek);
$('#labelChoosePre').html(lang.PREFERENCES_LBLCHOOSEOPFOOTER);
$('#labelMyPrefe').html(lang.PREFERENCES_BTNMINE);
$('#btnPreferences_update').html(lang.PREFERENCES_BTNUPDATE);
$('#txtPrefe').attr('placeholder', lang.PREFERENCES_HOLDERSEARCH);
$('.list-wrapper').jScroll({hScroll:false});
},
after:function(){
opc.type = ($_GET['typePrefe']!=''&&$_GET['typePrefe']!=undefined) ? $_GET['typePrefe'] : ($('#typePre').val()!=''?$('#typePre').val():1);

$('.fs-wrapper').jScroll({hScroll:false});
$('#radio-choice-'+opc.type).attr('checked', true).checkboxradio('refresh');
putBoxPreference(opc);
$('#typePre').val(opc.type);
}
});

function putBoxPreference(opc){
myAjax({
type :'GET',
url :DOMINIO+'controls/users/preferences.json.php?code='+$.local('code')+'&action=1',
dataType:'json',
error :function(/*resp,status,error*/){
myDialog('#singleDialog',lang.conectionFail);
},
success :function(data){
if (data['dato']){
opc.dato[1]=configArray(data['dato'][1],true);
opc.dato[2]=configArray(data['dato'][2],true);
opc.dato[3]=configArray(data['dato'][3],true); 
}else opc.dato=new Array("","","","");
$('#txtPrefe').val(opc.dato[opc.type]);
$("#btnPreferences_update").show();
}
});
}
function configArray(array,toString){
var out='';
if (toString)
for(i in array)
out+=(out!=''?', ':'')+array[i]['text'];
return out;
}
function changePrefe(opc,type){
opc.dato[opc.type]=$('#txtPrefe').val();
if (type) opc.type=type;
$('#txtPrefe').val(opc.dato[opc.type]);
$('#typePre').val(opc.type);
}
function savePreferences(opc){
changePrefe(opc);
myAjax({
type:'POST',
url:DOMINIO+'controls/users/preferences.json.php?code='+$.local('code')+'&action=up',
dataType:'json',
data:{preference_1:opc.dato[1].replace(/, /g,','),preference_2:opc.dato[2].replace(/, /g,','),preference_3:opc.dato[3].replace(/, /g,',')},
error:function(/*resp,status,error*/){
myDialog('#singleDialog',lang.conectionFail);
},
success:function(data){
if (data['insert'])
myDialog({
id:'#prefeExitoDialog',
content:'<br/>'+lang.PREFERENCES_MSJSUCESSFULLY+'<br/>',
buttons:{
'Close':function(){ this.close(); }
}
});
else 
myDialog({
id:'#prefeExitoDialog',
content:'<br/>'+lang.TAG_DELETEDERROR+'<br/>',
buttons:{
'Close':function(){ location.reload(); }
}
});
}
});
}
</script>
</div>
</body></html>
