Error en query (/seemytag/app/tag.php): Unknown column 'idioma' in 'field list'<br>SELECT idioma FROM geo_ip WHERE 0 BETWEEN start AND end<!DOCTYPE html>
<html><head>
<link rel="apple-touch-startup-image" href="css/smt/bg.png"/>
<link rel="apple-touch-icon" href="css/smt/screen-icon.png"/>
<meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=0"/>
<meta name="apple-mobile-web-app-capable" content="yes"/><meta name="apple-mobile-web-app-status-bar-style" content="black"/>
<title>Tagbum Mobile</title>
<link rel="icon" href="css/smt/favicon.ico" type="image/png"/>
<link rel="stylesheet" href="css/jquery.mobile.custom.css"/>
<link rel="stylesheet" href="css/jquery.mobile-1.3.2.css"/>
<link rel="stylesheet" href="css/jquery.Jcrop.css"/>
<link rel="stylesheet" href="css/iScroll.css"/>
<link rel="stylesheet" href="css/ptrScroll.css"/>
<link rel="stylesheet" href="css/farbtastic.css"/>
<link rel="stylesheet" href="css/seemytag.css"/>
<link rel="stylesheet" href="css/colorPicker.css"/>
<script src="http://localhost/cordova.js"></script>
<!--<script src="http://debug.build.phonegap.com/target/target-script-min.js#82ad4bcc-195f-11e3-af04-22000a98b3d6"></script><!-- -->
<script src="js/core/const.js"></script>
<script src="js/core/md5.js"></script>
<script src="js/core/jquery-1.10.2.min.js"></script>
<script src="js/core/jquery.cookie.js"></script>
<script src="js/core/jquery.local.js"></script>
<script src="js/core/session.js"></script>
<script src="js/core/jquery.mobile-1.3.2.js"></script>
<script src="js/core/jquery.form.js"></script>
<script src="js/core/jquery.textCounter.js"></script>
<script src="js/core/jquery.Jcrop.js"></script>
<script src="js/core/iScroll.js"></script>
<script src="js/core/jScroll.js"></script>
<script src="js/core/farbtastic.js"></script>
<script src="js/core/colorPicker.js"></script>
<script src="js/app.js"></script>
<script src="js/min.js"></script>
</head><body><div id="page-tag" data-role="page" data-cache="false">
<div data-role="header" data-theme="f" data-position="fixed">
<a href="#" id="buttonBack" data-icon="arrow-l"></a>
<h1 class="tag-title is-logged"></h1>
<a href="#" id="goProfile" data-icon="arrow-r" class="is-logged" style="display:none;"></a>
</div><!-- /header -->
<div data-role="content">
<img class="bg" src="img/bg.png"/>
<div id="fs-wrapper" class="fs-wrapper">
<div id="scroller">
<div id="noLoggedEmail" class="logoBackEmail" style="display:none"></div>
<div class="tag-solo"><div id="tag" class="tag-container"></div></div>
<div class="tag-solo-hash smt-tag-content"></div>
<div class="is-logged tag-comments-window smt-tag-content dnone">
<ul id="comments" data-role="listview" data-inset="true" class="tag-comments ui-listview" data-divider-theme="e"></ul>
</div>
</div>
</div>
</div>
<div id="tag-footer" class="tag-buttons" data-role="footer" data-theme="f" data-position="fixed" data-tap-toggle="false" style="text-align:center;">
<a id="redist" style="display:none;"></a>
<a id="like" style="display:none;" class="is-logged"></a>
<a id="dislike" style="display:none;" class="is-logged"></a>
<a id="share" style="display:none;"></a>
<a id="sponsor" style="display:none;"></a>
<a id="report" style="display:none;"></a>
<a id="delete" style="display:none;"></a>
<a id="youtube" style="display:none;" class="video" data-ajax="false"></a>
<a id="vimeo" style="display:none;" class="video" data-ajax="false"></a>
<a id="comment" style="display:none;" class="is-logged"></a>
<a id="qrcode" style="display:none;"></a>
</div>
<div id="popupVideo" data-role="popup" data-overlay-theme="a" data-theme="c" style="padding:7px;"></div>
<script>
var Change=isLogged();
pageShow({
id:'#page-tag',
before:function(){
$('#buttonBack').html(isLogged()?lang.back:lang.home).click(function(){ if(isLogged()) goBack(); else redir(PAGE['ini']); });
$('#goProfile').html(lang.profile);
$('#tagNoExits').html(lang.TAGS_WHENTAGNOEXIST);
},
login:function(logged){
if(logged!==Change) window.location.reload();
},
after:function(){
var likes=0,dislikes=0;
if(isLogged()){
$('.is-logged').fadeIn('slow');
}else{
$('#noLoggedEmail').show();
$('.not-logged').fadeIn('slow');
}
$('.fs-wrapper').jScroll({hScroll:false});
$('#comments').on('click','.more div',function(){
$(this).parents('li').removeClass('more').addClass('less');
$('.fs-wrapper').jScroll('refresh');
}).on('click','.less',function(){
$(this).removeClass('less').addClass('more');
$('.fs-wrapper').jScroll('refresh');
});
$('div.tag-solo-hash').on('click',function(){
$(this).addClass('tag-solo-hash-complete');
//$('a[hashT]',this).attr('hash',$('a[hashT]',this).attr('hashT')).removeAttr('hashT');
var vector=$('a[hashT]',this);
$.each(vector, function(key,value){
$(this).attr('hash',$(this).attr('hashT')).removeAttr('hashT');
});
}).on('click','a[hash]',function(){//tag-solo-hash-complete
redir(PAGE['search']+'?srh='+$(this).attr('hash').replace('#','%23').replace('<br>',' '));
});
var limit=100,
cdata={//comment data
type:4,
source:$_GET['id'],
mobile:1
};
function getComments(action,DATA,layer){
console.log('view comments');
action=action||'reload';
myAjax({
url:DOMINIO+'controls/comments/list.json.php',
dataType:'json',
data:$.extend(cdata,DATA||{}),
success:function(data){
if(!(data&&data['list']&&data['list'].length)) return;
var i,comment,salto,out='',$cont=$('#comments'),
head='<li data-role="list-divider">'+lang.COMMENTS_LBLCOMMENTS+
'<div id="numDislikes">'+dislikes+'</div>'+
'<div id="numLikes">'+likes+'</div>'+
'</li>';
for(i=0;i<data['list'].length;i++){
comment=data['list'][i];//alert(htmlDecode(comment));
salto=comment['comment'].length>limit;
out=
'<li'+(salto?' class="more"':'')+'>'+
'<img src="'+comment['photoUser']+'" class="ui-li-thumb" width="60" height="60" />'+
'<em class="ui-li-asid">'+comment['commentDate']+'</em>'+
'<div class="text">'+
'<h4>'+comment['nameUser']+'</h4>'+
'<p>'+comment['comment']+'</p>'+
'</div>'+
(salto?'<div class="seemore">'+lang.USER_BTNSEEMORE+'</div>':'')+
'<div class="clearfix"></div>'+
'</li>'+out;
}
$cont.find('.ui-li-divider').remove();
if(action=='reload') $cont.html(out);
else if(action=='refresh') $cont.append(out);
// else $cont.html(out);
$cont.prepend(head).listview('refresh');
if(layer){
$(layer).fadeOut(600,function(){
$(layer).remove();
});
}
$('.fs-wrapper').jScroll('refresh');
},
complete:function(){
cdata.txt=cdata.del=cdata.insert=null;
}
});
}
function dialogComment(id){
console.log('dialogComment. id='+id);
myDialog({
id:'#commentDialog',
style:{'margin-right':10},
content:
'<div style="padding:10px;"><textarea name="txtComment" id="txtComment" class="ui-input-text ui-body-c ui-corner-all ui-shadow-inset"'+
'style="resize:none;width:100%" rows="5" placeholder="'+lang.COMMENTS_LBLHELPIMPUTNEWCOMMENT+'"></textarea></div>',
buttons:[{
name:lang.send,
action:function(){
var comment=$.trim($('#txtComment').val());
if(comment!=''&&comment!=lang.COMMENTS_LBLHELPIMPUTNEWCOMMENT){
//comment = limpiaTextComentarios(comment);
getComments('reload',{insert:true,txt:comment},'#commentDialog');
}
// $('#commentDialog .closedialog').click();
$('.fs-wrapper').jScroll('refresh');
}
},{
name:lang.close,
action:'close'
}]
});
}
var test='';
myAjax({
type :'GET',
dataType:'json',
url :DOMINIO+'controls/tags/tagsList.json.php?id='+$_GET['id']+(is['iOS']?'&embed':''),
error :function(/*resp,status,error*/){
myDialog({
id:'#singleRedirDialog',
content:lang.TAG_CONTENTUNAVAILABLE,
buttons:{
Ok:function(){
redir(PAGE['timeline']);
}
}
});
},
success:function(data){
//alert(data['num_likes']);
//(tag['status']=='')?alert('vacio'):alert(tag['status']);
var tag=data&&data['tags']&&data['tags'][0];
if(tag['product']){
$('#qrcode').show();
// console.log(tag['product']);
test = tag['product']['app']; 
}
if(tag&&(tag['status']!='2')){
if(tag['hashTag']){
var jj,hashS='';
for(jj=0;jj<tag['hashTag'].length;jj++){
hashS+='<a href="#" hashT="'+tag['hashTag'][jj]+'">'+tag['hashTag'][jj]+'</a>&nbsp;&nbsp;';
}
// console.log($('div.tag-solo-hash'));
$('div.tag-solo-hash').html(hashS);
}
$('.tag-title').html(tag['rid']?tag['rname']+lang.TXT_REDIST:tag['uname']);
delete tag['uname'];
$('#tag').html(showTag(tag));
$('#goProfile').click(function(){
redir(PAGE['profile']+'?id='+tag['code']);
});
likes=tag['num_likes'];
dislikes=tag['num_disLikes'];
if(tag['redist']) $('.tag-icons #redist').fadeIn('slow');
var buttons=[],btn=tag['btn']||{};
if(btn['redist']) buttons.push('#redist');
if(btn['share']) buttons.push('#share');
if(btn['trash']) buttons.push('#delete');
if(btn['report']) buttons.push('#report');
if(buttons.length>0) $(buttons.join(),'.tag-buttons').fadeIn('slow');
if(tag['typeVideo']){
var $video=$('.tag-buttons #'+tag['typeVideo']).fadeIn('slow');
if(openVideo){
$video.click(function(){
openVideo(tag['video'],'#popupVideo');
});
}else
$video.attr({'href':tag['video'],'target':'_blank'});
}
myAjax({
type:'GET',
url:DOMINIO+'controls/tags/actionsTags.controls.php?action=12&tag='+$_GET['id'],
dataType:'html',
success:function(data){
data=data.split('|');
if(isLogged()){
if(data[2]==0) $('.tag-buttons #like, .tag-buttons #dislike').show();
if(data[2]>0){afterAjax(data, '.tag-buttons #like', '.tag-buttons #dislike');};
if(data[2]<0){afterAjax(data, '.tag-buttons #dislike', '.tag-buttons #like');};
}
}
});
}else{
$('#tag').html('<div id="tagNoExits" class="tagNoExits">'+lang.TAGS_WHENTAGNOEXIST+'.</div>'
+'<div class="smt-tag" style="max-height: 300px; height: 300px;"><img src="../img/templates/defaults/346f3ee097c010b4ed71ce0fb08bbaf2.jpg" class="tag-img"></div>');

}
getComments('reload');
windowFix();
}
});
function afterAjax(data,toHide,toShow){
//console.log(toHide+'--'+toShow);
if(data.indexOf('ERROR')<0)
$(toHide).fadeOut('slow',function(){
$(toShow).fadeIn('slow');
});
else
$('#error').html(data);
}
$('.tag-buttons a').not('.video').click(function(){
switch(this.id){
case 'report':redir(PAGE['reporttag']+'?id='+$_GET['id']);break;
case 'share':redir(PAGE['sharetag']+'?id_tag='+$_GET['id']);break;
case 'comment':dialogComment($_GET['id']);break;
case 'like':case 'dislike':
var that=this.id+'Icon',
show=that!='likeIcon'?'likeIcon':'dislikeIcon';
myAjax({
type:'GET',
url:DOMINIO+'controls/tags/actionsTags.controls.php?action='+(that=='likeIcon'?4:11)+'&tag='+$_GET['id'],
dataType:'html',
success:function( data ){
afterAjax(data,'.tag-icons #'+show,'.tag-icons #'+that);
myAjax({
type:'GET',
url:DOMINIO+'controls/tags/actionsTags.controls.php?action=12&tag='+$_GET['id'],
dataType:'html',
success:function( data ){
data= data.split('|');
likes=data[0];
dislikes=data[1];
if(data[2]>0){afterAjax(data, '.tag-buttons #like', '.tag-buttons #dislike');};
if(data[2]<0){afterAjax(data, '.tag-buttons #dislike', '.tag-buttons #like');};
$('#numLikes').html(likes);
$('#numDislikes').html(dislikes);
}
});
}
});
break;
case 'qrcode':
redir(test);

// myDialog({
// id:'#qrCodeDialog',
// content:test,
// buttons:[{
// name:lang.close,
// action:'close'
// }]
// });
break;
case 'redist':
myAjax({
type:'GET',
url:DOMINIO+'controls/tags/actionsTags.controls.php?action=3&tag='+$_GET['id'],
dataType:'html',
success:function( data ){
afterAjax(data, '.tag-buttons #redist', '.tag-icons #redist');
}
});
break;
case 'delete':
var url=$_GET['idGroup']?(PAGE['tagslist']+'?current=group&id='+$_GET['idGroup']):PAGE['timeline'];
myDialog({
id:'#singleRedirDialog',
content:lang.JS_DELETETAG,
buttons:[{
name:lang.yes,
action:function(){
myAjax({
type: 'GET',
url: DOMINIO+'controls/tags/actionsTags.controls.php?action=6&tag='+$_GET['id'],
dataType: 'html',
success: function( data ) {
redir(url);
}
});
}
},{
name:'No',
action:'close'
}]
});
break;
}
});
}
});
</script>
</div>
</body></html>
